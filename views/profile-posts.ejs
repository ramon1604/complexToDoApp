<%- include('header') -%>

<% if (user) { %><%- include('navLoggedin') %><% } else { %><%- include('navLoggedout') %><% } %>

<div class="container py-md-5 container--narrow">
  <%- include('flash') %>
  <h2><img class="avatar-small" src="<%= avatar %>"> <%= username %>
    <% if (user._id != _id) { %>
    <form class="ml-2 d-inline" action="/follow-author" method="POST">
      <input type="text" name="authorId" value="<%= _id %>" hidden>
      <input type="text" name="authorUsername" value="<%= username %>" hidden>
      <button class="btn btn-primary btn-sm">Follow <i class="fas fa-user-plus"></i></button>
    </form>
    <form class="ml-2 d-inline" action="/unfollow-author" method="POST">
      <input type="text" name="authorId" value="<%= _id %>" hidden>
      <input type="text" name="authorUsername" value="<%= username %>" hidden>
      <button class="btn btn-danger btn-sm">Stop Following <i class="fas fa-user-times"></i></button>
    </form>
    <% } %>
  </h2>

  <div class="profile-nav nav nav-tabs pt-2 mb-4">
    <a href="#" class="profile-nav-link nav-item nav-link active">Posts: <%= docsAuthor.length %></a>
    <a href="#" class="profile-nav-link nav-item nav-link ">Followers: 3</a>
    <a href="#" class="profile-nav-link nav-item nav-link ">Following: 2</a>
  </div>

  <div class="list-group">
    <% docsAuthor.forEach((post) => { %>
    <a href="/view-post/<%= post._id %>" class="list-group-item list-group-item-action">
      <img class="avatar-tiny" src="<%= avatar %>">
      <strong><%= post.title %></strong> on <%= post.createdDate.toLocaleDateString("en-US",{ year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric' }) %>
    </a>
    <% }) %>
  </div>
</div>

<%- include('footer') -%>